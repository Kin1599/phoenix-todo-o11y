# O11y platform

O11y Platform ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ Observability: –º–µ—Ç—Ä–∏–∫, –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ –∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

1. –°–µ—Ä–≤–∏—Å ‚Äì Elixir + Phoenix
2. –ë–î ‚Äì CocroachDB
3. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å ‚Äì Go + Vegeta
4. o11y-platform ‚Äì HTML, CSS, JavaScript
5. o11y ‚Äì Prometheus, Grafana, AlertManager, Portainer
6. Infra ‚Äì Docker, Docker Compose
7. Tracing ‚Äì Jaeger


## –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

| –ù–∞–∑–≤–∞–Ω–∏–µ                      | URL                                                           | –û–ø–∏—Å–∞–Ω–∏–µ                                                       |
| ----------------------------- | ------------------------------------------------------------- | -------------------------------------------------------------- |
| **Todo Task Manager Swagger** | [Swagger](http://158.160.178.32:4000/swagger/index.html#/)         | REST API –¥–ª—è –∑–∞–¥–∞—á, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è           |
| **Load Generator**            | [Load Generator](http://158.160.178.32:8081/)                      | UI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ª—é–±–æ–π —Å–µ—Ä–≤–∏—Å, –ø—Ä–æ—Ñ–∏–ª–∏ –Ω–∞–≥—Ä—É–∑–æ–∫    |
| **Database Admin Panel**      | [Database Admin Panel](http://158.160.178.32:8080/#/overview/list) | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å CockroachDB: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| **Grafana**                   | [Grafana](http://158.160.178.32:3000/)                             | –î–∞—à–±–æ—Ä–¥—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –∏ –∞–ª–µ—Ä—Ç–æ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã                   |
| **Prometheus**                | [Prometheus](http://158.160.178.32:9090/query)                     | –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫, PromQL-–∑–∞–ø—Ä–æ—Å—ã                    |
| **AlertManager**              | [AlertManager](http://158.160.178.32:9093/#/alerts)                | –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram                        |
| **O11y Platform Main Page**   | [O11y-platform](http://158.160.178.32/#)                        | –ü–æ—Ä—Ç–∞–ª –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è                                   |
| **Elixir Metrics**            | [Elixir /metrics](http://158.160.178.32:4000/metrics)              | –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (todo)                                      |
| **Database Metrics**          | [DB /\_status/vars](http://158.160.178.32:8080/_status/vars)       | –ú–µ—Ç—Ä–∏–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö CockroachDB                                |
| **Load Generator Metrics**    | [LoadGen /metrics](http://158.160.178.32:8081/metrics)             | –ú–µ—Ç—Ä–∏–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–∞–≥—Ä—É–∑–∫–∏                                    |
| **Telegram –∞–ª–µ—Ä—Ç—ã**           | [@o11y\_alerts](https://t.me/o11y_alerts)                     | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –∞–ª–µ—Ä—Ç–∞–º (latency, RPS)                          |

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø–æ /metrics

- –í Grafana –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –±–∞–∑—ã, –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

- –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ Prometheus/AlertManager, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Äî –≤ Telegram

## –î–æ—Å—Ç—É–ø—ã –∫ —Å–µ—Ä–≤–∏—Å–∞–º

1. Grafana admin/admin
2. Portainer admin/qwertyasdfgh

## –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–ª–µ—Ä—Ç–∏–Ω–≥

### ‚ùóÔ∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Content-Type: application/json

üî¥ HighLatency p99 > 500ms 

1. –í—ã–±—Ä–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–≥—Ä—É–∂–∞–µ–º–æ–π —Ä—É—á–∫–µ GET /api/tasks
2. –í –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –ø–æ—Å—Ç–∞–≤–∏—Ç—å:
```
Content-Type: application/json
Authorization: Bearer <token>
```
token –≤–∑—è—Ç—å –∏–∑ swagger /login, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å–æ–∑–¥–∞–Ω, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–∂–∞—Ç—å try out. 
3. –í –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ —É–∫–∞–∑–∞—Ç—å: 100 RPS, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 120 —Å–µ–∫—É–Ω–¥, –ø—Ä–æ—Ñ–∏–ª—å –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è

üü° HighDBLoad rps –≤ –ë–î > 100

1. –í—ã–±—Ä–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–≥—Ä—É–∂–∞–µ–º–æ–π —Ä—É—á–∫–µ POST /api/tasks
2. –í payload –ø–æ—Å—Ç–∞–≤–∏—Ç—å 
```
{
  "title": "Load2",
  "status": "pending",
  "description": "Testing..."
}
```
–í –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –ø–æ—Å—Ç–∞–≤–∏—Ç—å:
```
Content-Type: application/json
Authorization: Bearer <token>
```
token –≤–∑—è—Ç—å –∏–∑ swagger /login, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å–æ–∑–¥–∞–Ω, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–∂–∞—Ç—å try out. 
3. –í –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ —É–∫–∞–∑–∞—Ç—å: 100 RPS, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 120 —Å–µ–∫—É–Ω–¥, –ø—Ä–æ—Ñ–∏–ª—å –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è

## –ü—Ä–æ—Ñ–∏–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ Load Generator
| –ü—Ä–æ—Ñ–∏–ª—å           | –û–ø–∏—Å–∞–Ω–∏–µ                                                                           |
| ----------------- | ---------------------------------------------------------------------------------- |
| **–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è**    | –°—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π RPS –≤—Å—ë –≤—Ä–µ–º—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤)  |
| **–£–º–µ—Ä–µ–Ω–Ω–∞—è**     | RPS –≤ 2 —Ä–∞–∑–∞ –Ω–∏–∂–µ, —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è, –º—è–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞                                    |
| **–•–∞–æ—Ç–∏—á–Ω–∞—è**     | –†–∞–Ω–¥–æ–º–Ω—ã–µ –ø–∞—É–∑—ã, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏–º–∏—Ç–∏—Ä—É–µ—Ç –¥–µ—Ä–≥–∞–Ω—É—é —Ä–µ–∞–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É |
| **–°–ø–∞–π–∫–æ–≤–∞—è**     | –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –≤—Å–ø–ª–µ—Å–∫–∏: RPS √ó2 –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥                                     |
| **–í–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è** | –ü–ª–∞–≤–Ω–æ–µ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π –∏ –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (—Å–∏–Ω—É—Å–æ–ø–æ–¥–æ–±–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫)              |
| **–ù–∞–≥—Ä–µ–≤**        | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ RPS –æ—Ç 50% –¥–æ 100%                                          |
| **–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º**  | –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π RPS ‚Äî 10% –æ—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ (—Å–∏–º—É–ª—è—Ü–∏—è –Ω–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏/low traffic)        |

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
git clone https://github.com/Kin1599/phoenix-todo-o11y
cd phoenix-todo-o11y

# –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ —à–∞–±–ª–æ–Ω—É .env.sample
touch .env 

# –µ—Å–ª–∏ –Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–∫–µ, —Ç–æ –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å localhost –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ip/domain –≤ —Ñ–∞–π–ª–∞—Ö

docker compose up --build -d
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
–ü—Ä–æ—Ñ–∏–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ ¬´–°–ø–∞–π–∫–æ–≤–∞—è¬ª, ¬´–í–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è¬ª –∏ ¬´–ù–∞–≥—Ä–µ–≤¬ª –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Ç–∞–∫, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ, –∏–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ –ø–æ—á–∏–Ω–∏–ª(

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏ (5xx, timeouts), —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π RPS –º–æ–∂–µ—Ç –∫–æ–ª–µ–±–∞—Ç—å—Å—è ‚Äî —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, –∫–∞–∫ Vegeta –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

–ú–µ—Ç—Ä–∏–∫–∏ –≤ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ –∏ –≤ Grafana/Prometheus –º–æ–≥—É—Ç –Ω–µ–º–Ω–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∏—Ç—å—Å—è. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ä–∞–∑–Ω—ã–º –æ–∫–Ω–æ–º –∞–≥—Ä–µ–≥–∞—Ü–∏–∏. –ú–æ–∂–Ω–æ –ø–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å –æ–∫–Ω–æ–º –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤ edit panel, –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –í —Ü–µ–ª–æ–º —Ç–∞–º –ø–æ—á—Ç–∏ –≤—Å–µ –∏–¥–µ–∞–ª—å–Ω–æüòÅ
